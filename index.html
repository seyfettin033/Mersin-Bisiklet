<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>T√ºrkiye Camii Rehberi</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>

<style>
body {
    margin: 0;
    font-family: system-ui, -apple-system;
    background: #f4f6f8;
}

header {
    padding: 12px;
    background: #ffffff;
    border-bottom: 1px solid #ddd;
    text-align: center;
}

header b {
    color: #1f7a3a;
    font-size: 18px;
}

.controls {
    display: flex;
    gap: 10px;
    padding: 10px;
    background: #fff;
    border-bottom: 1px solid #ddd;
}

select {
    flex: 1;
    padding: 8px;
    font-size: 14px;
}

#stats {
    padding: 8px;
    text-align: center;
    font-size: 14px;
    background: #eef5ef;
    color: #1f7a3a;
    font-weight: 600;
}

#map {
    height: calc(100vh - 160px);
}

.btn {
    display: block;
    padding: 6px;
    margin-top: 5px;
    text-align: center;
    font-weight: 600;
    border-radius: 5px;
    text-decoration: none;
}

.osm { background:#2e7d32; color:#fff; }
.google { background:#fbbc04; color:#000; }
</style>
</head>

<body>

<header>
üïå <b>T√ºrkiye Camii Rehberi</b><br>
<small>ƒ∞simsiz Camiler ‚Äì OSM D√ºzeltme Aracƒ±</small>
</header>

<div class="controls">
<select id="ilSec">
<option value="">ƒ∞l se√ßiniz</option>
<option value="konya">Konya</option>
<option value="istanbul">ƒ∞stanbul</option>
<option value="ankara">Ankara</option>
<option value="izmir">ƒ∞zmir</option>
</select>
</div>

<div id="stats">Hen√ºz veri y√ºklenmedi</div>
<div id="map"></div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<script>
var map = L.map('map').setView([39,35],6);

L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',{
    maxZoom:19
}).addTo(map);

var layerGroup = L.layerGroup().addTo(map);

// ƒ∞l bazlƒ± bounding box‚Äôlar
const iller = {
    konya: [37.5,31.0,38.8,33.0],
    istanbul: [40.8,28.4,41.3,29.4],
    ankara: [39.5,32.2,40.2,33.1],
    izmir: [38.0,26.5,39.0,27.8]
};

document.getElementById("ilSec").addEventListener("change", function(){
    var il = this.value;
    if(!il) return;

    layerGroup.clearLayers();
    document.getElementById("stats").innerText = "Y√ºkleniyor...";

    var bbox = iller[il];

    var query = `
    [out:json][timeout:60];
    (
      node["amenity"="place_of_worship"]["religion"="muslim"]["name"!~"."](${bbox.join(",")});
      way["amenity"="place_of_worship"]["religion"="muslim"]["name"!~"."](${bbox.join(",")});
    );
    out center;
    `;

    fetch("https://overpass-api.de/api/interpreter", {
        method:"POST",
        body:query
    })
    .then(r=>r.json())
    .then(data=>{
        let count = 0;

        data.elements.forEach(el=>{
            let lat = el.lat || el.center.lat;
            let lon = el.lon || el.center.lon;

            let osm = `https://www.openstreetmap.org/edit?editor=id#map=19/${lat}/${lon}`;
            let google = `https://www.google.com/maps/search/cami/@${lat},${lon},19z`;

            L.circleMarker([lat,lon],{
                radius:6,
                color:"#1f7a3a",
                fillOpacity:0.85
            }).addTo(layerGroup)
            .bindPopup(`
                <b>‚ùó ƒ∞simsiz Cami</b><br>
                <a class="btn osm" href="${osm}" target="_blank">OSM'de D√ºzelt</a>
                <a class="btn google" href="${google}" target="_blank">Google'da Kontrol</a>
            `);

            count++;
        });

        document.getElementById("stats").innerText =
            `${count} adet isimsiz cami bulundu`;
    });
});
</script>

</body>
</html>