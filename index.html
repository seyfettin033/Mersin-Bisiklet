<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>TÃ¼rkiye Camii Rehberi</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>

<style>
html, body { height:100%; margin:0; }
body {
  font-family: system-ui, -apple-system;
  background:#f4f5f7;
  color:#1f2937;
}
header {
  background:#fff;
  padding:12px;
  border-bottom:1px solid #e5e7eb;
  text-align:center;
}
header h1 {
  margin:0;
  font-size:18px;
  color:#14532d;
}
header small { color:#6b7280; }

.etiket {
  background:#ecfdf5;
  color:#065f46;
  text-align:center;
  font-size:12px;
  padding:6px;
  border-bottom:1px solid #d1fae5;
}

.filters {
  padding:10px;
  background:#fff;
  border-bottom:1px solid #e5e7eb;
}
select {
  width:100%;
  padding:8px;
  border-radius:6px;
  border:1px solid #d1d5db;
  font-size:14px;
}

#sayac {
  background:#fff;
  padding:10px;
  text-align:center;
  font-size:14px;
  font-weight:600;
  color:#14532d;
  border-bottom:1px solid #e5e7eb;
}

#map { height: calc(100vh - 210px); }

/* Popup */
.popup { font-size:14px; }
.popup b { color:#14532d; }
.popup a {
  display:block;
  text-align:center;
  padding:8px;
  margin-top:6px;
  border-radius:6px;
  text-decoration:none;
  font-weight:600;
  font-size:13px;
}
.osm { background:#166534; color:#fff; }
.google { background:#fde047; color:#000; }
.diyanet { background:#1e3a8a; color:#fff; }
</style>
</head>

<body>

<header>
  <h1>ğŸ•Œ TÃ¼rkiye Camii Rehberi</h1>
  <small>Ä°simsiz Camiler â€“ OSM DÃ¼zeltme HaritasÄ±</small>
</header>

<div class="etiket">
â„¹ï¸ Bu proje OpenStreetMap verilerinin doÄŸruluÄŸunu artÄ±rmak amacÄ±yla, tamamen toplumsal fayda iÃ§in hazÄ±rlanmÄ±ÅŸtÄ±r.
</div>

<div class="filters">
  <select id="il">
    <option value="">Ä°l seÃ§iniz</option>
  </select>
</div>

<div id="sayac">HenÃ¼z il seÃ§ilmedi</div>
<div id="map"></div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<script>
// 81 Ä°l (otomatik yÃ¼kleme)
const iller = [
"Adana","AdÄ±yaman","Afyonkarahisar","AÄŸrÄ±","Amasya","Ankara","Antalya","Artvin",
"AydÄ±n","BalÄ±kesir","Bilecik","BingÃ¶l","Bitlis","Bolu","Burdur","Bursa",
"Ã‡anakkale","Ã‡ankÄ±rÄ±","Ã‡orum","Denizli","DiyarbakÄ±r","Edirne","ElazÄ±ÄŸ",
"Erzincan","Erzurum","EskiÅŸehir","Gaziantep","Giresun","GÃ¼mÃ¼ÅŸhane","Hakkari",
"Hatay","Isparta","Mersin","Ä°stanbul","Ä°zmir","Kars","Kastamonu","Kayseri",
"KÄ±rklareli","KÄ±rÅŸehir","Kocaeli","Konya","KÃ¼tahya","Malatya","Manisa",
"KahramanmaraÅŸ","Mardin","MuÄŸla","MuÅŸ","NevÅŸehir","NiÄŸde","Ordu","Rize",
"Sakarya","Samsun","Siirt","Sinop","Sivas","TekirdaÄŸ","Tokat","Trabzon",
"Tunceli","ÅanlÄ±urfa","UÅŸak","Van","Yozgat","Zonguldak","Aksaray","Bayburt",
"Karaman","KÄ±rÄ±kkale","Batman","ÅÄ±rnak","BartÄ±n","Ardahan","IÄŸdÄ±r","Yalova",
"KarabÃ¼k","Kilis","Osmaniye","DÃ¼zce"
];

const ilSelect = document.getElementById("il");
iller.forEach(il => {
  const o = document.createElement("option");
  o.value = il;
  o.textContent = il;
  ilSelect.appendChild(o);
});

// Harita
const map = L.map('map').setView([39,35], 6);
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
  maxZoom:19,
  attribution:'Â© OpenStreetMap'
}).addTo(map);

const layer = L.layerGroup().addTo(map);

// Ä°l seÃ§imi
ilSelect.addEventListener("change", function() {
  const il = this.value;
  if (!il) return;

  layer.clearLayers();
  document.getElementById("sayac").innerHTML = il + " â€“ YÃ¼kleniyor...";

  const query = `
  [out:json][timeout:40];
  area["name"="${il}"]["admin_level"="4"]->.a;
  (
    node["amenity"="place_of_worship"]["religion"="muslim"]["name"!~"."](area.a);
    way["amenity"="place_of_worship"]["religion"="muslim"]["name"!~"."](area.a);
  );
  out center;
  `;

  fetch("https://overpass-api.de/api/interpreter", {
    method:"POST",
    body:query
  })
  .then(r=>r.json())
  .then(data=>{
    const adet = data.elements.length;
    const sayac = document.getElementById("sayac");

    if (adet === 0) {
      sayac.innerHTML = il + " â€“ Ä°simsiz cami bulunamadÄ±";
      return;
    }

    sayac.innerHTML = il + " â€“ <b>" + adet + "</b> isimsiz cami bulundu";

    const bounds = [];
    data.elements.forEach(el => {
      const lat = el.lat || el.center.lat;
      const lon = el.lon || el.center.lon;
      bounds.push([lat,lon]);

      const popup = `
      <div class="popup">
        <b>â— Ä°simsiz Cami</b>

        <a class="google" target="_blank"
           href="https://www.google.com/maps/search/cami/@${lat},${lon},19z">
           ğŸ” Googleâ€™da Kontrol
        </a>

        <a class="diyanet" target="_blank"
           href="https://camiler.diyanet.gov.tr">
           ğŸ•Œ Diyanetâ€™te Sorgula
        </a>

        <a class="osm" target="_blank"
           href="https://www.openstreetmap.org/edit?editor=id#map=19/${lat}/${lon}">
           âœï¸ OSM'de Ä°sim Gir
        </a>
      </div>`;

      L.circleMarker([lat,lon], {
        radius:6,
        color:"#14532d",
        weight:2,
        fillColor:"#22c55e",
        fillOpacity:0.85
      }).addTo(layer).bindPopup(popup);
    });

    map.fitBounds(bounds, {padding:[30,30]});
  });
});
</script>

</body>
</html>