<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TÃ¼rkiye Camii Rehberi</title>

<style>
body{
    margin:0;
    padding:14px;
    font-family:system-ui,-apple-system;
    background:#f2f4f7;
}
header{
    background:#fff;
    padding:12px;
    border-radius:10px;
    margin-bottom:12px;
}
h1{
    margin:0;
    font-size:20px;
    color:#1f5e2b;
    text-align:center;
}
.stats{
    text-align:center;
    font-size:14px;
    margin-top:6px;
    color:#555;
}
select{
    width:100%;
    margin-top:8px;
    padding:8px;
    border-radius:6px;
    border:1px solid #ccc;
}
.card{
    background:#fff;
    border-radius:12px;
    padding:14px;
    margin-bottom:12px;
    border-left:5px solid #1f5e2b;
}
.cami-adi{
    font-weight:600;
    margin-bottom:8px;
    display:block;
}
.btn{
    display:block;
    padding:10px;
    text-align:center;
    border-radius:6px;
    font-weight:600;
    text-decoration:none;
    margin-top:6px;
}
.git{background:#007bff;color:#fff;}
.osm{background:#28a745;color:#fff;}
.google{background:#fbbc05;color:#000;}
</style>
</head>

<body>

<header>
    <h1>ğŸ•Œ TÃ¼rkiye Camii Rehberi</h1>
    <div class="stats" id="sayac">Ä°l seÃ§iniz</div>

    <select id="il">
        <option value="">Ä°l SeÃ§iniz</option>
    </select>

    <select id="ilce" disabled>
        <option value="">Ä°lÃ§e SeÃ§iniz</option>
    </select>
</header>

<div id="liste"></div>

<script>
const ilSelect = document.getElementById("il");
const ilceSelect = document.getElementById("ilce");
const liste = document.getElementById("liste");
const sayac = document.getElementById("sayac");

// 81 il (sadece isim â€“ hafif)
const iller = [
"Adana","AdÄ±yaman","Afyonkarahisar","AÄŸrÄ±","Amasya","Ankara","Antalya","Artvin","AydÄ±n",
"BalÄ±kesir","Bilecik","BingÃ¶l","Bitlis","Bolu","Burdur","Bursa","Ã‡anakkale","Ã‡ankÄ±rÄ±",
"Ã‡orum","Denizli","DiyarbakÄ±r","Edirne","ElazÄ±ÄŸ","Erzincan","Erzurum","EskiÅŸehir",
"Gaziantep","Giresun","GÃ¼mÃ¼ÅŸhane","Hakkari","Hatay","Isparta","Mersin","Ä°stanbul",
"Ä°zmir","Kars","Kastamonu","Kayseri","KÄ±rklareli","KÄ±rÅŸehir","Kocaeli","Konya",
"KÃ¼tahya","Malatya","Manisa","KahramanmaraÅŸ","Mardin","MuÄŸla","MuÅŸ","NevÅŸehir",
"NiÄŸde","Ordu","Rize","Sakarya","Samsun","Siirt","Sinop","Sivas","TekirdaÄŸ",
"Tokat","Trabzon","Tunceli","ÅanlÄ±urfa","UÅŸak","Van","Yozgat","Zonguldak","Aksaray",
"Bayburt","Karaman","KÄ±rÄ±kkale","Batman","ÅÄ±rnak","BartÄ±n","Ardahan","IÄŸdÄ±r","Yalova",
"KarabÃ¼k","Kilis","Osmaniye","DÃ¼zce"
];

iller.forEach(il=>{
    ilSelect.innerHTML += `<option value="${il}">${il}</option>`;
});

// Ä°l seÃ§ildiÄŸinde ilÃ§eleri getir
ilSelect.onchange = ()=>{
    ilceSelect.innerHTML = `<option value="">Ä°lÃ§e SeÃ§iniz</option>`;
    ilceSelect.disabled = true;
    liste.innerHTML = "";
    sayac.innerText = "Ä°lÃ§eler yÃ¼kleniyorâ€¦";

    fetch(`https://nominatim.openstreetmap.org/search?country=Turkey&state=${ilSelect.value}&format=json&limit=1`)
    .then(r=>r.json())
    .then(()=>{
        // Ä°lÃ§eleri Nominatim'den Ã§ek
        return fetch(`https://nominatim.openstreetmap.org/search?country=Turkey&state=${ilSelect.value}&format=json&addressdetails=1&limit=100`);
    })
    .then(r=>r.json())
    .then(data=>{
        let ilceler = new Set();
        data.forEach(d=>{
            if(d.address && d.address.county){
                ilceler.add(d.address.county);
            }
        });

        ilceler.forEach(i=>{
            ilceSelect.innerHTML += `<option value="${i}">${i}</option>`;
        });

        ilceSelect.disabled = false;
        sayac.innerText = "Ä°lÃ§e seÃ§iniz";
    });
};

// Ä°lÃ§e seÃ§ildiÄŸinde camileri getir
ilceSelect.onchange = ()=>{
    liste.innerHTML = "YÃ¼kleniyorâ€¦";
    sayac.innerText = "HesaplanÄ±yorâ€¦";

    fetch(`https://nominatim.openstreetmap.org/search?country=Turkey&state=${ilSelect.value}&county=${ilceSelect.value}&format=json&limit=1`)
    .then(r=>r.json())
    .then(d=>{
        if(!d.length) return;

        let b = d[0].boundingbox;
        let bbox = [b[0],b[2],b[1],b[3]];

        let query = `
        [out:json][timeout:40];
        (
          node["amenity"="place_of_worship"]["religion"="muslim"]["name"!~"."](${bbox.join(",")});
          way["amenity"="place_of_worship"]["religion"="muslim"]["name"!~"."](${bbox.join(",")});
        );
        out center;
        `;

        return fetch("https://overpass-api.de/api/interpreter",{method:"POST",body:query});
    })
    .then(r=>r.json())
    .then(d=>{
        sayac.innerText = `${d.elements.length} isimsiz cami bulundu`;
        let html="";
        d.elements.forEach(el=>{
            let lat = el.lat || el.center.lat;
            let lon = el.lon || el.center.lon;
            html+=`
            <div class="card">
                <span class="cami-adi">â— Ä°simsiz Cami (OSM ID: ${el.id})</span>
                <a class="btn osm" target="_blank"
                   href="https://www.openstreetmap.org/edit?editor=id#map=19/${lat}/${lon}">
                   âœï¸ OSMâ€™de Ä°sim Gir
                </a>
            </div>`;
        });
        liste.innerHTML = html || "Bu ilÃ§ede isimsiz cami yok ğŸ‰";
    });
};
</script>

</body>
</html>