<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <title>TÃ¼rkiye Camii Rehberi - OSM DÃ¼zenleme</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
    <style>
        html, body { height: 100%; margin: 0; }
        body { font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; background: #f4f5f7; color: #1f2937; display: flex; flex-direction: column; }
        
        header { background: #ffffff; padding: 15px; border-bottom: 2px solid #14532d; box-shadow: 0 2px 4px rgba(0,0,0,0.1); z-index: 1000; }
        header h1 { margin: 0; font-size: 20px; color: #14532d; text-align: center; }
        header small { display: block; text-align: center; color: #6b7280; margin-top: 4px; }

        .etiket { background: #ecfdf5; color: #065f46; text-align: center; font-size: 12px; padding: 8px; border-bottom: 1px solid #d1fae5; }

        .controls { padding: 12px; background: #ffffff; display: flex; flex-direction: column; gap: 8px; border-bottom: 1px solid #e5e7eb; }
        select { width: 100%; padding: 10px; border-radius: 8px; border: 1px solid #d1d5db; font-size: 15px; cursor: pointer; background: #fff; }

        #sayac { background: #f9fafb; padding: 10px; text-align: center; font-size: 14px; font-weight: 600; color: #14532d; }

        #map { flex-grow: 1; width: 100%; }

        /* Popup TasarÄ±mÄ± */
        .popup-box { padding: 5px; min-width: 160px; }
        .popup-box b { color: #b91c1c; display: block; margin-bottom: 8px; font-size: 15px; }
        .btn { display: block; text-align: center; padding: 10px; margin-top: 8px; border-radius: 6px; text-decoration: none; font-weight: bold; font-size: 13px; transition: opacity 0.2s; }
        .btn:hover { opacity: 0.85; }
        .osm { background: #166534; color: #ffffff; }
        .google { background: #fde047; color: #000000; }
    </style>
</head>
<body>

<header>
    <h1>ğŸ•Œ TÃ¼rkiye Camii Rehberi</h1>
    <small>Veri GeliÅŸtirme ve Ä°simlendirme Paneli</small>
</header>

<div class="etiket">
    ğŸ’¡ OpenStreetMap Ã¼zerindeki eksik cami isimlerini tamamlayarak topluma katkÄ±da bulunun.
</div>

<div class="controls">
    <select id="il">
        <option value="">Bir il seÃ§in ve taramaya baÅŸlayÄ±n...</option>
        <option>Adana</option><option>AdÄ±yaman</option><option>Afyonkarahisar</option><option>AÄŸrÄ±</option><option>Amasya</option><option>Ankara</option><option>Antalya</option><option>Artvin</option><option>AydÄ±n</option><option>BalÄ±kesir</option><option>Bilecik</option><option>BingÃ¶l</option><option>Bitlis</option><option>Bolu</option><option>Burdur</option><option>Bursa</option><option>Ã‡anakkale</option><option>Ã‡ankÄ±rÄ±</option><option>Ã‡orum</option><option>Denizli</option><option>DiyarbakÄ±r</option><option>Edirne</option><option>ElazÄ±ÄŸ</option><option>Erzincan</option><option>Erzurum</option><option>EskiÅŸehir</option><option>Gaziantep</option><option>Giresun</option><option>GÃ¼mÃ¼ÅŸhane</option><option>Hakkari</option><option>Hatay</option><option>Isparta</option><option>Mersin</option><option>Ä°stanbul</option><option>Ä°zmir</option><option>Kars</option><option>Kastamonu</option><option>Kayseri</option><option>KÄ±rklareli</option><option>KÄ±rÅŸehir</option><option>Kocaeli</option><option>Konya</option><option>KÃ¼tahya</option><option>Malatya</option><option>Manisa</option><option>KahramanmaraÅŸ</option><option>Mardin</option><option>MuÄŸla</option><option>MuÅŸ</option><option>NevÅŸehir</option><option>NiÄŸde</option><option>Ordu</option><option>Rize</option><option>Sakarya</option><option>Samsun</option><option>Siirt</option><option>Sinop</option><option>Sivas</option><option>TekirdaÄŸ</option><option>Tokat</option><option>Trabzon</option><option>Tunceli</option><option>ÅanlÄ±urfa</option><option>UÅŸak</option><option>Van</option><option>Yozgat</option><option>Zonguldak</option><option>Aksaray</option><option>Bayburt</option><option>Karaman</option><option>KÄ±rÄ±kkale</option><option>Batman</option><option>ÅÄ±rnak</option><option>BartÄ±n</option><option>Ardahan</option><option>IÄŸdÄ±r</option><option>Yalova</option><option>KarabÃ¼k</option><option>Kilis</option><option>Osmaniye</option><option>DÃ¼zce</option>
    </select>
</div>

<div id="sayac">BaÅŸlamak iÃ§in listeden bir ÅŸehir seÃ§in.</div>

<div id="map"></div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<script>
    var map = L.map('map').setView([38.9637, 35.2433], 6);

    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        maxZoom: 19,
        attribution: 'Â© OpenStreetMap KatkÄ±da Bulunanlar'
    }).addTo(map);

    var layer = L.layerGroup().addTo(map);

    document.getElementById("il").addEventListener("change", function () {
        var il = this.value;
        if (!il) return;

        layer.clearLayers();
        document.getElementById("sayac").innerHTML = "âŒ› " + il + " verisi Overpass'ten Ã§ekiliyor...";

        var query = `
        [out:json][timeout:60];
        area["name"="${il}"]["admin_level"="4"]->.a;
        (
          node["amenity"="place_of_worship"]["religion"="muslim"]["name"!~"."](area.a);
          way["amenity"="place_of_worship"]["religion"="muslim"]["name"!~"."](area.a);
        );
        out center;`;

        fetch("https://overpass-api.de/api/interpreter", {
            method: "POST",
            body: query
        })
        .then(r => r.json())
        .then(data => {
            var elements = data.elements;
            var sayac = document.getElementById("sayac");

            if (elements.length === 0) {
                sayac.innerHTML = "ğŸ‰ Harika! " + il + " ilinde isimsiz cami kalmamÄ±ÅŸ.";
                return;
            }

            sayac.innerHTML = il + " â€“ <b>" + elements.length + "</b> isimsiz cami bulundu.";

            var coords = [];

            elements.forEach(el => {
                var lat = el.lat || el.center.lat;
                var lon = el.lon || el.center.lon;
                coords.push([lat, lon]);

                // Google Haritalar linki dÃ¼zeltildi
                var gMapLink = `https://www.google.com/maps/search/?api=1&query=${lat},${lon}`;
                var osmEditLink = `https://www.openstreetmap.org/edit?editor=id#map=19/${lat}/${lon}`;

                var popupContent = `
                <div class="popup-box">
                    <b>âš ï¸ Ä°simsiz Cami</b>
                    <a class="btn osm" target="_blank" href="${osmEditLink}">âœï¸ OSM'de DÃ¼zenle</a>
                    <a class="btn google" target="_blank" href="${gMapLink}">ğŸ” Google'da DoÄŸrula</a>
                </div>`;

                L.circleMarker([lat, lon], {
                    radius: 7,
                    color: "#064e3b",
                    fillColor: "#10b981",
                    fillOpacity: 0.8,
                    weight: 2
                })
                .addTo(layer)
                .bindPopup(popupContent);
            });

            // HaritayÄ± bulunan noktalarÄ±n olduÄŸu bÃ¶lgeye odakla
            if (coords.length > 0) {
                map.fitBounds(L.latLngBounds(coords), { padding: [30, 30] });
            }
        })
        .catch(err => {
            console.error(err);
            document.getElementById("sayac").innerHTML = "âŒ Veri Ã§ekilirken bir hata oluÅŸtu.";
        });
    });
</script>

</body>
</html>

