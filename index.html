<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TÃ¼rkiye Camileri Rehberi | Filtreli</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <style>
        body { margin: 0; display: flex; font-family: sans-serif; height: 100vh; }
        #sidebar { width: 300px; background: #fff; border-right: 2px solid #e74c3c; padding: 20px; box-sizing: border-box; z-index: 1000; }
        #map { flex-grow: 1; }
        .filter-group { margin-bottom: 20px; }
        select { width: 100%; padding: 10px; border-radius: 5px; border: 1px solid #ccc; margin-top: 5px; }
        h2 { color: #e74c3c; font-size: 18px; border-bottom: 2px solid #eee; padding-bottom: 10px; }
        .btn-yol { background: #e74c3c; color: white; display: block; text-align: center; padding: 8px; text-decoration: none; border-radius: 5px; margin-top: 5px; }
    </style>
</head>
<body>

<div id="sidebar">
    <h2>ðŸ‡¹ðŸ‡· Cami Rehberi</h2>
    <div class="filter-group">
        <label>Åžehir SeÃ§in:</label>
        <select id="ilSec" onchange="ilDegisti()">
            <option value="">SeÃ§iniz...</option>
            <option value="Mersin">Mersin</option>
            <option value="Ä°stanbul">Ä°stanbul</option>
        </select>
    </div>
    <div class="filter-group">
        <label>Ä°lÃ§e SeÃ§in:</label>
        <select id="ilceSec" onchange="filtrele()">
            <option value="">Ã–nce Ä°l SeÃ§in</option>
        </select>
    </div>
    <p id="bilgi" style="font-size: 12px; color: #666;"></p>
</div>

<div id="map"></div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
    var map = L.map('map').setView([39.0, 35.0], 6);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);

    // Hata vermemesi iÃ§in "Sabit ve DoÄŸru" Veri Seti
    var tumVeriler = [
        {il: "Mersin", ilce: "YeniÅŸehir", ad: "MuÄŸdat Camii", lat: 36.7876, lng: 34.6198},
        {il: "Mersin", ilce: "Akdeniz", ad: "Mersin Ulu Cami", lat: 36.8001, lng: 34.6308},
        {il: "Mersin", ilce: "Mezitli", ad: "Mezitli Merkez Cami", lat: 36.7560, lng: 34.5320},
        {il: "Ä°stanbul", ilce: "Fatih", ad: "Sultanahmet Camii", lat: 41.0054, lng: 28.9768},
        {il: "Ä°stanbul", ilce: "Fatih", ad: "Ayasofya-i Kebir Cami", lat: 41.0085, lng: 28.9799}
    ];

    var ilceler = {
        "Mersin": ["YeniÅŸehir", "Akdeniz", "Mezitli", "Tarsus"],
        "Ä°stanbul": ["Fatih", "ÃœskÃ¼dar", "BeÅŸiktaÅŸ"]
    };

    var markerGrubu = L.layerGroup().addTo(map);

    function ilDegisti() {
        var il = document.getElementById("ilSec").value;
        var ilceSelect = document.getElementById("ilceSec");
        ilceSelect.innerHTML = '<option value="">TÃ¼mÃ¼</option>';
        
        if (il && ilceler[il]) {
            ilceler[il].forEach(i => {
                ilceSelect.innerHTML += `<option value="${i}">${i}</option>`;
            });
            // SeÃ§ilen ile odaklan
            var ilkVeri = tumVeriler.find(v => v.il === il);
            if(ilkVeri) map.setView([ilkVeri.lat, ilkVeri.lng], 12);
        }
        filtrele();
    }

    function filtrele() {
        markerGrubu.clearLayers();
        var secilenIl = document.getElementById("ilSec").value;
        var secilenIlce = document.getElementById("ilceSec").value;
        var sayac = 0;

        tumVeriler.forEach(v => {
            if ((secilenIl === "" || v.il === secilenIl) && (secilenIlce === "" || v.ilce === secilenIlce)) {
                var m = L.marker([v.lat, v.lng]).addTo(markerGrubu);
                m.bindPopup(`<b>${v.ad}</b><br>${v.il} / ${v.ilce}<br><a href="https://www.google.com/maps?q=${v.lat},${v.lng}" target="_blank" class="btn-yol">Yol Tarifi</a>`);
                sayac++;
            }
        });
        document.getElementById("bilgi").innerText = sayac + " cami listelendi.";
    }
</script>
</body>
</html>
